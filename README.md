<h1>MCDiscordLink REST API</h1>

This API is yet to be hosted, the domain for this API is also still undecided.

<h2>Usage</h2>

<h3>Deploying</h3>

To deploy, create a ``Python 3`` virtual environment and install all of the packages using ``pip`` found in ``requirements.txt``. You can do this by executing the following command in the root directory of the project.

```
pip install -r requirements.txt
```

After doing this we need to setup a superuser for the django project, and assign this user an ``Authorization token`` using ``django-admin``. You can do this by executing the following commands:

```
python3 manage.py createsuperuser --username Andy --email andy@andeh.uk

python3 manage.py drf_create_token Andy
```

The username and email can be anything, the values listed above are simply examples.

After running the commands listed above you will be presented with your Authorization token, you should use this token whenever you make  a request to the API.

<h3>Settings.py</h3>

Before deploying we need to edit a few settings inside ``settings.py``, first of all you should most definitely change the Secret Key found on Line 23, do **NOT** make this public, this should also be strong and unique. 

We also need to whitelist the domain that the API will be hosted under, remove ``"localhost"`` and ``"127.0.0.1"`` from ``ALLOWED_HOSTS`` on Line 28 and replace it with your domain.

<h3>Starting the API</h3>

Before starting the API you need to migrate the Database Models to a sqlite3 database (that is the database this API uses) to do this you need to run the following commands:

```
python3 manage.py makemigrations
python3 manage.py migrate
```

Finally, we just need to start the django server to run the API. You can do this by doing:

```
python3 manage.py runserver [port]
```

``[port]`` is optional, this defaults to ``8000`` if a port is not specified.

<h3>Authorization</h3>
To use this API you must have a Token generated by the django aplication directly and include this token in the request headers as shown below:

```json
{"Authorization": "Token <Token goes here>"}
```

<h3>JSON Data</h3>
For some requests you need to provide JSON data, the required data should mimic the data payload shown below:

```json
{
    "code": "12345", // Must be a 5 digit code, required field
    "minecraft_name": "ExHiraku", // Required field
    "discord_id": "957437570546012240" // Optional Field
}
```

<h3>Getting all Players</h3>

```
GET https://mydomain.com/players
```

<h3>Getting a specific player</h3>

```
GET https://mydomain.com/players?code=12345
GET https://mydomain.com/players?minecraft_name=ExHiraku
GET https://mydomain.com/players?discord_id=957437570546012240
```

<h3>Updating a specific player</h3>

The ID arg is required for this request to work. The ID for a player can be found under the "id" key in the player data json when fetching a player's data. JSON data as seen at the top of this document is also required.

```
PUT https://mydomain.com/players/<id>
```

<h3>Deleting a specific player</h3>

The ID arg acts the same as found above for updating a specific player.

**WARNING:** Providing no arguments will cause the API to **DELETE ALL DATA** on the Database.

```
DELETE https://mydomain.com/players?code=12345
DELETE https://mydomain.com/players?minecraft_name=ExHiraku
DELETE https://mydomain.com/players?discord_id=957437570546012240
DELETE https://mydomain.com/players/<id>
```

<h3>Deleting all players' data</h3>

```
DELETE https://mydomain.com/players
```